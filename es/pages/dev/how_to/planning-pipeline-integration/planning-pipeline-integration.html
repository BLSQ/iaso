
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="../../../../../assets/iaso-favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.1">
    
    
      
        <title>Planning-Pipeline Integration Documentation - IASO</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#planning-pipeline-integration-documentation" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../../../../index.html" title="IASO" class="md-header__button md-logo" aria-label="IASO" data-md-component="logo">
      
  <img src="../../../../../assets/iaso.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IASO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Planning-Pipeline Integration Documentation
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Seleccionar idioma">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../../../../pages/dev/how_to/planning-pipeline-integration/planning-pipeline-integration.html" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="../../../../../fr/pages/dev/how_to/planning-pipeline-integration/planning-pipeline-integration.html" hreflang="fr" class="md-select__link">
                    Français
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="planning-pipeline-integration.html" hreflang="es" class="md-select__link">
                    Español
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/BLSQ/iaso" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
<!-- Navigation -->


<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
    <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
            


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../index.html" title="IASO" class="md-nav__button md-logo" aria-label="IASO" data-md-component="logo">
      
  <img src="../../../../../assets/iaso.png" alt="logo">

    </a>
    IASO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BLSQ/iaso" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../index.html" class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Guía de usuario
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Guía de usuario
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../users/reference/iaso_concepts/iaso_concepts.html" class="md-nav__link">
        Conceptos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../users/reference/iaso_modules/iaso_modules.html" class="md-nav__link">
        Módulos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../users/reference/iaso_web/user_guide.html" class="md-nav__link">
        Plataforma Web
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../users/reference/iaso_mobile/iaso_mobile.html" class="md-nav__link">
        Aplicación Móvil
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Desarrolladores
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Desarrolladores
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Referencias
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Referencias
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/data_model_glossary/data_model_glossary.html" class="md-nav__link">
        Data model glossary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/sql_dashboard/SQL_Dashboard_feature.html" class="md-nav__link">
        SQL Dashboard feature
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/docker/docker.html" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/background_tasks/background_tasks.html" class="md-nav__link">
        Background tasks & worker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/env_variables/env_variables.html" class="md-nav__link">
        Environnement variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_6" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1_6" id="__nav_3_1_6_label" tabindex="0">
          Modelos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_6">
          <span class="md-nav__icon md-icon"></span>
          Modelos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/API/entity.html" class="md-nav__link">
        API reference: Entity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Guías
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Guías
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribute/contribute.html" class="md-nav__link">
        Contribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup_dev_env/setup_dev_env.html" class="md-nav__link">
        Setup a dev environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../use_iaso_apis/use_iaso_apis.html" class="md-nav__link">
        Use iaso apis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Más sobre IASO
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Más sobre IASO
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.openiaso.com/" class="md-nav__link">
        Sitio web de IASO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.digitalpublicgoods.net/r/iaso" class="md-nav__link">
        Digital Public Goods Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/BLSQ/iaso/releases" class="md-nav__link">
        Notas de versión
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.bluesquarehub.com/" class="md-nav__link">
        Sitio web de Bluesquare
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
            <!-- pdf download  -->
            <div id="pdf-download-container">
                <button id="pdf-download" type="button">
                    <span id="button-text">Download current page</span>
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                        fill="#192041">
                        <path
                            d="M360-460h40v-80h40q17 0 28.5-11.5T480-580v-40q0-17-11.5-28.5T440-660h-80v200Zm40-120v-40h40v40h-40Zm120 120h80q17 0 28.5-11.5T640-500v-120q0-17-11.5-28.5T600-660h-80v200Zm40-40v-120h40v120h-40Zm120 40h40v-80h40v-40h-40v-40h40v-40h-80v200ZM320-240q-33 0-56.5-23.5T240-320v-480q0-33 23.5-56.5T320-880h480q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H320Zm0-80h480v-480H320v480ZM160-80q-33 0-56.5-23.5T80-160v-560h80v560h560v80H160Zm160-720v480-480Z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Table of contents -->


<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
    <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
            

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-overview" class="md-nav__link">
    Architecture Overview
  </a>
  
    <nav class="md-nav" aria-label="Architecture Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-components" class="md-nav__link">
    Core Components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow" class="md-nav__link">
    Data Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-models" class="md-nav__link">
    Data Models
  </a>
  
    <nav class="md-nav" aria-label="Data Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#planning-model" class="md-nav__link">
    Planning Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orgunittype-hierarchy" class="md-nav__link">
    OrgUnitType Hierarchy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#team-hierarchy" class="md-nav__link">
    Team Hierarchy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-integration" class="md-nav__link">
    Pipeline Integration
  </a>
  
    <nav class="md-nav" aria-label="Pipeline Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline-parameters" class="md-nav__link">
    Pipeline Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameter-structure" class="md-nav__link">
    Parameter Structure
  </a>
  
    <nav class="md-nav" aria-label="Parameter Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#org_unit_type_sequence_identifiers" class="md-nav__link">
    org_unit_type_sequence_identifiers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#org_unit_type_quantities" class="md-nav__link">
    org_unit_type_quantities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#org_unit_type_exceptions" class="md-nav__link">
    org_unit_type_exceptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection_host" class="md-nav__link">
    connection_host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection_token" class="md-nav__link">
    connection_token
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-execution-flow" class="md-nav__link">
    Pipeline Execution Flow
  </a>
  
    <nav class="md-nav" aria-label="Pipeline Execution Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iaso-side-backend" class="md-nav__link">
    Iaso Side (Backend)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openhexa-side-pipeline" class="md-nav__link">
    OpenHEXA Side (Pipeline)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-management" class="md-nav__link">
    Status Management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-authentication" class="md-nav__link">
    API Authentication
  </a>
  
    <nav class="md-nav" aria-label="API Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generic-api-caller" class="md-nav__link">
    Generic API Caller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-acquisition" class="md-nav__link">
    Token Acquisition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-testing" class="md-nav__link">
    Connection Testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-status-updates" class="md-nav__link">
    Task Status Updates
  </a>
  
    <nav class="md-nav" aria-label="Task Status Updates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-pipeline-progress-updates-optional" class="md-nav__link">
    1. Pipeline Progress Updates (Optional)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-automatic-status-polling-system" class="md-nav__link">
    2. Automatic Status Polling System
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#background-task-system" class="md-nav__link">
    Background Task System
  </a>
  
    <nav class="md-nav" aria-label="Background Task System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-creation-and-management" class="md-nav__link">
    Task Creation and Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-benefits" class="md-nav__link">
    Key Benefits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polling-behavior" class="md-nav__link">
    Polling Behavior
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openhexa-configuration" class="md-nav__link">
    OpenHexa Configuration
  </a>
  
    <nav class="md-nav" aria-label="OpenHexa Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-parameters" class="md-nav__link">
    Configuration Parameters
  </a>
  
    <nav class="md-nav" aria-label="Configuration Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-parameters" class="md-nav__link">
    Required Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-parameters" class="md-nav__link">
    Optional Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-example" class="md-nav__link">
    Configuration Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-endpoint" class="md-nav__link">
    Configuration Endpoint
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-endpoints" class="md-nav__link">
    API Endpoints
  </a>
  
    <nav class="md-nav" aria-label="API Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline-management" class="md-nav__link">
    Pipeline Management
  </a>
  
    <nav class="md-nav" aria-label="Pipeline Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launch-pipeline" class="md-nav__link">
    Launch Pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-task-status-pipeline-iaso" class="md-nav__link">
    Update Task Status (Pipeline → Iaso)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic-status-updates-iaso-openhexa" class="md-nav__link">
    Automatic Status Updates (Iaso → OpenHEXA)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-improvements" class="md-nav__link">
    Architecture Improvements
  </a>
  
    <nav class="md-nav" aria-label="Architecture Improvements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-benefits-of-the-new-architecture" class="md-nav__link">
    Key Benefits of the New Architecture
  </a>
  
    <nav class="md-nav" aria-label="Key Benefits of the New Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-reliable-status-management" class="md-nav__link">
    1. Reliable Status Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-robust-pipeline-execution" class="md-nav__link">
    2. Robust Pipeline Execution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-simplified-pipeline-development" class="md-nav__link">
    3. Simplified Pipeline Development
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-better-user-experience" class="md-nav__link">
    4. Better User Experience
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-improved-maintainability" class="md-nav__link">
    5. Improved Maintainability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-from-previous-architecture" class="md-nav__link">
    Migration from Previous Architecture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best Practices
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-pipeline-developers" class="md-nav__link">
    For Pipeline Developers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-frontend-developers" class="md-nav__link">
    For Frontend Developers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assignment-management" class="md-nav__link">
    Assignment Management
  </a>
  
    <nav class="md-nav" aria-label="Assignment Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delete-all-assignments-for-planning" class="md-nav__link">
    Delete All Assignments for Planning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-create-assignments" class="md-nav__link">
    Bulk Create Assignments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frontend-integration" class="md-nav__link">
    Frontend Integration
  </a>
  
    <nav class="md-nav" aria-label="Frontend Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-workflow" class="md-nav__link">
    User Workflow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#planning-configuration-ui" class="md-nav__link">
    Planning Configuration UI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assignment-view-ui-map-page" class="md-nav__link">
    Assignment View UI (Map Page)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workflow-details" class="md-nav__link">
    Workflow Details
  </a>
  
    <nav class="md-nav" aria-label="Workflow Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-planning-creationedition" class="md-nav__link">
    Step 1: Planning Creation/Edition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-assignment-map-view" class="md-nav__link">
    Step 2: Assignment Map View
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-launch-sample" class="md-nav__link">
    Step 3: Launch Sample
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-parameter-configuration" class="md-nav__link">
    Step 4: Parameter Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-pipeline-execution" class="md-nav__link">
    Step 5: Pipeline Execution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-rules" class="md-nav__link">
    Validation Rules
  </a>
  
    <nav class="md-nav" aria-label="Validation Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hierarchy-validation" class="md-nav__link">
    Hierarchy Validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-validation" class="md-nav__link">
    Pipeline Validation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    Error Handling
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-error-scenarios" class="md-nav__link">
    Common Error Scenarios
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-response-format" class="md-nav__link">
    Error Response Format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
        </div>
    </div>
</div>



          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/BLSQ/iaso/edit/main/docs/pages/dev/how_to/planning-pipeline-integration/planning-pipeline-integration.en.md" title="Editar esta página" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="planning-pipeline-integration-documentation">Planning-Pipeline Integration Documentation<a class="headerlink" href="#planning-pipeline-integration-documentation" title="Permanent link">#</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p>This document describes the integration between Iaso's Planning feature and OpenHexa pipelines for automated assignment generation. The integration allows users to configure sampling parameters and automatically generate assignments of organizational units to teams/users using LQAS (Lot Quality Assurance Sampling) algorithms.</p>
<h2 id="architecture-overview">Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permanent link">#</a></h2>
<h3 id="core-components">Core Components<a class="headerlink" href="#core-components" title="Permanent link">#</a></h3>
<ol>
<li><strong>Planning System</strong>: Manages planning configurations and assignment results</li>
<li><strong>OpenHexa Integration</strong>: Handles pipeline execution and task management</li>
<li><strong>Assignment Engine</strong>: Generates assignments based on pipeline results</li>
<li><strong>UI Components</strong>: Frontend interfaces for configuration and monitoring</li>
</ol>
<h3 id="data-flow">Data Flow<a class="headerlink" href="#data-flow" title="Permanent link">#</a></h3>
<pre><code>Planning Configuration → Pipeline Parameters → OpenHexa Execution → Assignment Generation → UI Display
</code></pre>
<h2 id="data-models">Data Models<a class="headerlink" href="#data-models" title="Permanent link">#</a></h2>
<h3 id="planning-model">Planning <strong>Model</strong><a class="headerlink" href="#planning-model" title="Permanent link">#</a></h3>
<pre><code class="language-python">class Planning(SoftDeletableModel):
    name = models.CharField(max_length=100)
    description = models.TextField(blank=True)
    project = models.ForeignKey(Project, on_delete=models.PROTECT)
    started_at = models.DateField(null=True, blank=True)
    ended_at = models.DateField(null=True, blank=True)
    forms = models.ManyToManyField(Form, related_name=&quot;plannings&quot;)
    team = models.ForeignKey(Team, on_delete=models.CASCADE)  # Main team
    org_unit = models.ForeignKey(OrgUnit, on_delete=models.PROTECT)  # Root org unit (usually country)
    published_at = models.DateTimeField(null=True, blank=True)
    created_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    pipeline_uuids = ArrayField(
        models.CharField(max_length=36),
        default=list,
        blank=True,
        help_text=&quot;List of OpenHexa pipeline UUIDs available for this planning&quot;,
    )
</code></pre>
<p><strong>Key Fields</strong>:
- <code>pipeline_uuids</code>:  Array of OpenHexa pipeline UUIDs that can be used for this planning. This allows linking specific pipelines to a planning configuration.</p>
<pre><code>
### Assignment Model

```python
class Assignment(SoftDeletableModel):
    planning = models.ForeignKey(&quot;Planning&quot;, on_delete=models.CASCADE)
    org_unit = models.ForeignKey(&quot;OrgUnit&quot;, on_delete=models.CASCADE)
    user = models.ForeignKey(User, on_delete=models.SET_NULL, null=True, blank=True)
    team = models.ForeignKey(Team, on_delete=models.SET_NULL, null=True, blank=True)
    created_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        unique_together = [[&quot;planning&quot;, &quot;org_unit&quot;]]
</code></pre>
<h3 id="orgunittype-hierarchy">OrgUnitType Hierarchy<a class="headerlink" href="#orgunittype-hierarchy" title="Permanent link">#</a></h3>
<pre><code class="language-python">class OrgUnitType(models.Model):
    name = models.CharField(max_length=255)  # e.g., &quot;Country&quot;, &quot;Region&quot;, &quot;District&quot;, &quot;Health Facility&quot;
    short_name = models.CharField(max_length=255)
    depth = models.PositiveSmallIntegerField(null=True, blank=True)  # Hierarchy level
    sub_unit_types = models.ManyToManyField(&quot;OrgUnitType&quot;, related_name=&quot;super_types&quot;, blank=True)
    projects = models.ManyToManyField(&quot;Project&quot;, related_name=&quot;unit_types&quot;, blank=False)

    CATEGORIES = [
        (&quot;COUNTRY&quot;, _(&quot;Country&quot;)),
        (&quot;REGION&quot;, _(&quot;Region&quot;)),
        (&quot;DISTRICT&quot;, _(&quot;District&quot;)),
        (&quot;HF&quot;, _(&quot;Health Facility&quot;)),
    ]
    category = models.CharField(max_length=8, choices=CATEGORIES, null=True, blank=True)
</code></pre>
<h3 id="team-hierarchy">Team Hierarchy<a class="headerlink" href="#team-hierarchy" title="Permanent link">#</a></h3>
<pre><code class="language-python">class Team(SoftDeletableModel):
    name = models.CharField(max_length=100)
    description = models.TextField(blank=True)
    project = models.ForeignKey(Project, on_delete=models.PROTECT)
    users = models.ManyToManyField(User, related_name=&quot;teams&quot;, blank=True)
    manager = models.ForeignKey(User, on_delete=models.PROTECT, related_name=&quot;managed_teams&quot;)
    parent = models.ForeignKey(&quot;self&quot;, on_delete=models.PROTECT, null=True, blank=True, related_name=&quot;sub_teams&quot;)
    path = PathField(unique=True)  # Hierarchical path
    type = models.CharField(choices=TeamType.choices, max_length=100, null=True, blank=True)

class TeamType(models.TextChoices):
    TEAM_OF_TEAMS = &quot;TEAM_OF_TEAMS&quot;, &quot;Team of teams&quot;
    TEAM_OF_USERS = &quot;TEAM_OF_USERS&quot;, &quot;Team of users&quot;
</code></pre>
<h2 id="pipeline-integration">Pipeline Integration<a class="headerlink" href="#pipeline-integration" title="Permanent link">#</a></h2>
<h3 id="pipeline-parameters">Pipeline Parameters<a class="headerlink" href="#pipeline-parameters" title="Permanent link">#</a></h3>
<p>The OpenHexa pipeline receives the following parameters:</p>
<pre><code class="language-python">@pipeline
def lqas_assignment_pipeline(
    planning_id: int,
    task_id: int,
    org_unit_type_sequence_identifiers: List[int],  # [398, 399, 400] - IDs from higher to lower level
    org_unit_type_quantities: List[int],            # [2, 3, 4] - quantities at each level
    org_unit_type_exceptions: List[str],            # [&quot;12098,108033&quot;, &quot;&quot;, &quot;&quot;] - exceptions per level
    connection_host: str,                           # &quot;http://localhost:8081&quot; - Iaso server URL
    connection_token: str,                          # Session token for authentication
):
    &quot;&quot;&quot;
    LQAS Assignment Pipeline

    Args:
        planning_id: ID of the planning to generate assignments for
        task_id: ID of the task for status updates
        org_unit_type_sequence_identifiers: List of org unit type IDs in hierarchy order (top to bottom)
        org_unit_type_quantities: List of quantities to select at each level
        org_unit_type_exceptions: List of comma-separated org unit IDs to exclude at each level
        connection_host: Host URL of the Iaso server (e.g., &quot;http://localhost:8081&quot;)
        connection_token: Session token for authentication
    &quot;&quot;&quot;
</code></pre>
<h3 id="parameter-structure">Parameter Structure<a class="headerlink" href="#parameter-structure" title="Permanent link">#</a></h3>
<h4 id="org_unit_type_sequence_identifiers">org_unit_type_sequence_identifiers<a class="headerlink" href="#org_unit_type_sequence_identifiers" title="Permanent link">#</a></h4>
<ul>
<li><strong>Type</strong>: <code>List[int]</code></li>
<li><strong>Description</strong>: IDs of org unit types in hierarchical order (from highest to lowest level)</li>
<li><strong>Example</strong>: <code>[398, 399, 400]</code> where:</li>
<li><code>398</code> = Country level</li>
<li><code>399</code> = Region level  </li>
<li><code>400</code> = District level</li>
</ul>
<h4 id="org_unit_type_quantities">org_unit_type_quantities<a class="headerlink" href="#org_unit_type_quantities" title="Permanent link">#</a></h4>
<ul>
<li><strong>Type</strong>: <code>List[int]</code></li>
<li><strong>Description</strong>: Number of org units to select at each level</li>
<li><strong>Example</strong>: <code>[2, 3, 4]</code> means:</li>
<li>Select 2 countries</li>
<li>From each country, select 3 regions</li>
<li>From each region, select 4 districts</li>
<li>Total: 2 × 3 × 4 = 24 districts</li>
</ul>
<h4 id="org_unit_type_exceptions">org_unit_type_exceptions<a class="headerlink" href="#org_unit_type_exceptions" title="Permanent link">#</a></h4>
<ul>
<li><strong>Type</strong>: <code>List[str]</code></li>
<li><strong>Description</strong>: Org unit IDs to exclude from random sampling at each level. Each string contains comma-separated IDs of org units to ignore during sampling at that specific level.</li>
<li><strong>Example</strong>: <code>["12098,108033", "", ""]</code> means:</li>
<li>Exclude countries with IDs 12098 and 108033 (comma-separated in first string)</li>
<li>No region exceptions (empty string)</li>
<li>No district exceptions (empty string)</li>
</ul>
<h4 id="connection_host">connection_host<a class="headerlink" href="#connection_host" title="Permanent link">#</a></h4>
<ul>
<li><strong>Type</strong>: <code>str</code></li>
<li><strong>Description</strong>: Host URL of the Iaso server to connect to. This enables multitenant support by allowing pipelines to connect to different Iaso instances. This URL is automatically generated during pipeline launch based on the current request.</li>
<li><strong>Example</strong>: <code>"http://localhost:8081"</code> or <code>"https://iaso.example.com"</code></li>
<li><strong>Note</strong>: This parameter is automatically added to the config by the backend during pipeline launch - it should not be provided by the frontend.</li>
</ul>
<h4 id="connection_token">connection_token<a class="headerlink" href="#connection_token" title="Permanent link">#</a></h4>
<ul>
<li><strong>Type</strong>: <code>str</code></li>
<li><strong>Description</strong>: JWT Bearer token for authentication with the Iaso API. This token is automatically generated during pipeline launch using the authenticated user's credentials and used in the <code>Authorization: Bearer {token}</code> header.</li>
<li><strong>Example</strong>: <code>"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."</code> (JWT access token)</li>
<li><strong>Note</strong>: This parameter is automatically added to the config by the backend during pipeline launch - it should not be provided by the frontend.</li>
</ul>
<h3 id="pipeline-execution-flow">Pipeline Execution Flow<a class="headerlink" href="#pipeline-execution-flow" title="Permanent link">#</a></h3>
<h4 id="iaso-side-backend">Iaso Side (Backend)<a class="headerlink" href="#iaso-side-backend" title="Permanent link">#</a></h4>
<ol>
<li><strong>Task Creation</strong>: Create background task using <code>beanstalk_worker</code> decorator</li>
<li><strong>Pipeline Launch</strong>: Launch OpenHEXA pipeline via GraphQL API</li>
<li><strong>Continuous Polling</strong>: Start background polling loop to monitor pipeline status</li>
<li><strong>Status Synchronization</strong>: Update Iaso task status to match OpenHEXA pipeline status</li>
<li><strong>Result Handling</strong>: Process pipeline results when completed</li>
</ol>
<h4 id="openhexa-side-pipeline">OpenHEXA Side (Pipeline)<a class="headerlink" href="#openhexa-side-pipeline" title="Permanent link">#</a></h4>
<ol>
<li><strong>Connection Test</strong>: Validate connection to Iaso API using provided host and token</li>
<li><strong>Validation</strong>: Verify org unit type hierarchy matches team hierarchy</li>
<li><strong>Sampling</strong>: Apply LQAS algorithm to select org units</li>
<li><strong>Assignment</strong>: Assign selected org units to teams/users</li>
<li><strong>Progress Updates</strong>: Optionally update task progress throughout execution</li>
<li><strong>Result Storage</strong>: Store final assignments in Iaso database</li>
</ol>
<h4 id="status-management">Status Management<a class="headerlink" href="#status-management" title="Permanent link">#</a></h4>
<ul>
<li><strong>Automatic</strong>: Iaso polling system handles all status transitions</li>
<li><strong>Real-time</strong>: Status updates happen automatically as OpenHEXA pipeline progresses</li>
<li><strong>Reliable</strong>: Configurable timeout protection - prevents ghost tasks while allowing sufficient execution time</li>
<li><strong>Aligned</strong>: Iaso task status always matches OpenHEXA pipeline status</li>
</ul>
<h3 id="api-authentication">API Authentication<a class="headerlink" href="#api-authentication" title="Permanent link">#</a></h3>
<p>The pipeline uses JWT Bearer token authentication instead of OpenHexa's connection system. This approach provides better multitenant support, security, and direct control over API calls.</p>
<h4 id="generic-api-caller">Generic API Caller<a class="headerlink" href="#generic-api-caller" title="Permanent link">#</a></h4>
<pre><code class="language-python">def call_api(
    base_url: str,
    endpoint: str,
    bearer_token: str,
    method: str = &quot;GET&quot;,
    data: Optional[Dict] = None,
    params: Optional[Dict] = None,
) -&gt; Any:
    &quot;&quot;&quot;
    Generic API caller that uses Bearer token authentication.

    Args:
        base_url (str): Root server URL, e.g. &quot;http://localhost:8081&quot;
        endpoint (str): API endpoint, e.g. &quot;/api/forms/&quot; (no trailing slash required)
        bearer_token (str): JWT Bearer token for authentication
        method (str): HTTP method, default &quot;GET&quot; (can be &quot;POST&quot;, &quot;PUT&quot;, &quot;PATCH&quot;, &quot;DELETE&quot;)
        data (dict, optional): Data payload for POST/PUT/PATCH
        params (dict, optional): Query params for GET requests

    Returns:
        dict or str: JSON response if possible, otherwise raw text
    &quot;&quot;&quot;
</code></pre>
<h4 id="token-acquisition">Token Acquisition<a class="headerlink" href="#token-acquisition" title="Permanent link">#</a></h4>
<p>JWT tokens for pipeline authentication are automatically generated by the backend during pipeline launch:</p>
<pre><code class="language-python"># Backend automatically generates JWT token during pipeline launch
config[&quot;connection_token&quot;] = get_user_token(request.user)
config[&quot;connection_host&quot;] = f&quot;{scheme}://{host}&quot;
</code></pre>
<p>The backend uses the authenticated user's credentials to generate a JWT access token that can be used as a Bearer token for API authentication. This approach ensures that:</p>
<ul>
<li>The token is always valid and properly scoped to the authenticated user</li>
<li>No additional API calls are needed from the frontend</li>
<li>Token generation is handled securely on the server side</li>
<li>The token is automatically included in the pipeline configuration</li>
</ul>
<h4 id="connection-testing">Connection Testing<a class="headerlink" href="#connection-testing" title="Permanent link">#</a></h4>
<p>The pipeline includes a connection test function that validates API connectivity before proceeding:</p>
<pre><code class="language-python">def test_connection(connection_host: str, connection_token: str) -&gt; bool:
    &quot;&quot;&quot;
    Test the connection to Iaso API.

    Args:
        connection_host: Host URL of the Iaso server
        connection_token: JWT Bearer token for authentication

    Returns:
        bool: True if connection is successful, False otherwise
    &quot;&quot;&quot;
</code></pre>
<p><strong>Benefits of this approach:</strong>
- <strong>Automatic Token Generation</strong>: JWT tokens are generated server-side during pipeline launch
- <strong>Multitenant Support</strong>: Each pipeline run can connect to different Iaso instances
- <strong>Standard Authentication</strong>: Uses industry-standard JWT Bearer token authentication
- <strong>Better Performance</strong>: No dependency on OpenHexa's connection management
- <strong>Error Handling</strong>: Proper connection testing and error reporting
- <strong>Security</strong>: JWT tokens are time-limited and secure, generated with user's credentials
- <strong>Clean Implementation</strong>: No cookie access issues or HttpOnly problems
- <strong>Compatibility</strong>: Works seamlessly with existing Django JWT setup
- <strong>Simplified Frontend</strong>: Frontend doesn't need to handle token acquisition</p>
<h3 id="task-status-updates">Task Status Updates<a class="headerlink" href="#task-status-updates" title="Permanent link">#</a></h3>
<p>The pipeline integration uses a dual approach for task status management:</p>
<h4 id="1-pipeline-progress-updates-optional">1. Pipeline Progress Updates (Optional)<a class="headerlink" href="#1-pipeline-progress-updates-optional" title="Permanent link">#</a></h4>
<p>The pipeline can optionally update progress and messages using the generic API caller:</p>
<pre><code class="language-python">def safe_update_task_status(
    task_id: Optional[int],
    message: str,
    connection_host: str,
    connection_token: str,
    pipeline_id: str,
    progress_value: Optional[int] = None,
    end_value: Optional[int] = None,
    result_data: Optional[Dict] = None,
    status: Optional[str] = None,  # Optional - not used by default
):
    &quot;&quot;&quot;Safely update task progress and messages in Iaso.&quot;&quot;&quot;
    # Uses call_api() function to send PATCH request to /api/openhexa/pipelines/{pipeline_id}/
    # with task_id, progress_message, progress_value, end_value, result_data
    # Status updates are handled by the polling system, not the pipeline
</code></pre>
<h4 id="2-automatic-status-polling-system">2. Automatic Status Polling System<a class="headerlink" href="#2-automatic-status-polling-system" title="Permanent link">#</a></h4>
<p>The main status management is handled by Iaso's background task system that continuously polls OpenHEXA for pipeline status:</p>
<pre><code class="language-python">@task_decorator(task_name=&quot;launch_openhexa_pipeline&quot;)
def launch_openhexa_pipeline(
    pipeline_id: str,
    openhexa_url: str,
    openhexa_token: str,
    version: str,
    config: dict,
    delay: int = 2,
    max_polling_duration_minutes: int = 10,
    task: Task = None,
):
    &quot;&quot;&quot;
    Background task that:
    1. Launches the OpenHEXA pipeline
    2. Continuously polls OpenHEXA for status updates
    3. Updates Iaso task status to match OpenHEXA pipeline status
    4. Handles all status transitions automatically
    5. Times out after max_polling_duration_minutes to prevent ghost tasks
    &quot;&quot;&quot;
</code></pre>
<p><strong>Key Features</strong>:
- <strong>Continuous Polling</strong>: Polls OpenHEXA until pipeline reaches final state or timeout
- <strong>Configurable Timeout</strong>: Default 10-minute timeout prevents ghost tasks (configurable via <code>max_polling_duration_minutes</code>)
- <strong>Status Alignment</strong>: Iaso task status always matches OpenHEXA pipeline status
- <strong>Automatic Transitions</strong>: Handles all status changes automatically
- <strong>Error Handling</strong>: Proper error handling and logging
- <strong>Timeout Protection</strong>: Prevents indefinite polling that could create ghost tasks</p>
<p><strong>Timeout Implementation</strong>:</p>
<pre><code class="language-python"># Check if polling timeout has been reached
current_time = datetime.now()
elapsed_time = current_time - polling_start_time
if elapsed_time &gt; max_polling_duration:
    timeout_message = (
        f&quot;Polling timeout reached after {max_polling_duration_minutes} minutes for pipeline {pipeline_id}&quot;
    )
    logger.warning(timeout_message)
    task.report_failure(Exception(timeout_message))
    return
</code></pre>
<p><strong>Status Values</strong>:
- <code>QUEUED</code>: Pipeline is queued for execution
- <code>RUNNING</code>: Pipeline is executing
- <code>SUCCESS</code>: Pipeline completed successfully
- <code>ERRORED</code>: Pipeline failed with error
- <code>EXPORTED</code>: Pipeline results have been exported
- <code>SKIPPED</code>: Pipeline execution was skipped
- <code>KILLED</code>: Pipeline was terminated</p>
<p><strong>OpenHEXA Status Mapping</strong>:
- <code>success</code>, <code>completed</code>, <code>done</code> → <code>SUCCESS</code>
- <code>failed</code>, <code>errored</code>, <code>cancelled</code>, <code>error</code> → <code>ERRORED</code>
- <code>running</code>, <code>queued</code>, <code>pending</code>, <code>started</code> → <code>RUNNING</code></p>
<h3 id="background-task-system">Background Task System<a class="headerlink" href="#background-task-system" title="Permanent link">#</a></h3>
<p>The integration uses Iaso's <code>beanstalk_worker</code> system for reliable background task execution:</p>
<h4 id="task-creation-and-management">Task Creation and Management<a class="headerlink" href="#task-creation-and-management" title="Permanent link">#</a></h4>
<pre><code class="language-python"># Task is automatically created by the decorator
@task_decorator(task_name=&quot;launch_openhexa_pipeline&quot;)
def launch_openhexa_pipeline(user, pipeline_id, openhexa_url, openhexa_token, version, config, delay=2, task=None):
    &quot;&quot;&quot;
    Single task handles both pipeline launch and continuous monitoring
    &quot;&quot;&quot;
    # 1. Set task properties
    task.external = True
    task.status = QUEUED

    # 2. Launch OpenHEXA pipeline
    ExternalTaskModelViewSet.launch_task(...)

    # 3. Start continuous polling loop
    while True:
        # Poll OpenHEXA for status
        # Update Iaso task status accordingly
        # Handle final states (SUCCESS/ERRORED)
</code></pre>
<h4 id="key-benefits">Key Benefits<a class="headerlink" href="#key-benefits" title="Permanent link">#</a></h4>
<ul>
<li><strong>Single Task</strong>: One task handles both launch and monitoring (no separate polling tasks)</li>
<li><strong>User Association</strong>: Task is automatically associated with the launching user</li>
<li><strong>Reliable Execution</strong>: Uses Iaso's proven background task system</li>
<li><strong>Status Consistency</strong>: Task status always reflects OpenHEXA pipeline status</li>
<li><strong>Error Handling</strong>: Proper error handling and logging throughout</li>
<li><strong>Kill Support</strong>: Respects task kill signals for graceful termination</li>
</ul>
<h4 id="polling-behavior">Polling Behavior<a class="headerlink" href="#polling-behavior" title="Permanent link">#</a></h4>
<ul>
<li><strong>Continuous</strong>: Polls until pipeline reaches final state or timeout</li>
<li><strong>Efficient</strong>: Only logs status changes, not every poll attempt</li>
<li><strong>Configurable</strong>: Polling delay can be adjusted (default: 2 seconds)</li>
<li><strong>Timeout Protection</strong>: Default 10-minute timeout prevents ghost tasks</li>
<li><strong>Robust</strong>: Handles network errors and continues polling</li>
<li><strong>Aligned</strong>: Iaso task status always matches OpenHEXA pipeline status</li>
</ul>
<h2 id="openhexa-configuration">OpenHexa Configuration<a class="headerlink" href="#openhexa-configuration" title="Permanent link">#</a></h2>
<h3 id="configuration-parameters">Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Permanent link">#</a></h3>
<p>The OpenHexa integration requires configuration stored in the <code>Config</code> model with slug <code>"openhexa-config"</code>. The configuration includes:</p>
<h4 id="required-parameters">Required Parameters<a class="headerlink" href="#required-parameters" title="Permanent link">#</a></h4>
<ul>
<li><code>openhexa_url</code>: The GraphQL endpoint URL for OpenHexa</li>
<li><code>openhexa_token</code>: Authentication token for OpenHexa API</li>
<li><code>workspace_slug</code>: The workspace identifier in OpenHexa</li>
</ul>
<h4 id="optional-parameters">Optional Parameters<a class="headerlink" href="#optional-parameters" title="Permanent link">#</a></h4>
<ul>
<li><code>lqas_pipeline_code</code>: The pipeline code used to display a custom form for LQAS sampling in the OpenHexa integration UI. This enables specialized LQAS sampling forms when available.</li>
</ul>
<h3 id="configuration-example">Configuration Example<a class="headerlink" href="#configuration-example" title="Permanent link">#</a></h3>
<pre><code class="language-json">{
    &quot;openhexa_url&quot;: &quot;https://openhexa.example.com/graphql/&quot;,
    &quot;openhexa_token&quot;: &quot;your-api-token-here&quot;,
    &quot;workspace_slug&quot;: &quot;your-workspace&quot;,
    &quot;lqas_pipeline_code&quot;: &quot;lqas-sampling-pipeline&quot;,
}
</code></pre>
<h3 id="configuration-endpoint">Configuration Endpoint<a class="headerlink" href="#configuration-endpoint" title="Permanent link">#</a></h3>
<p>The system provides an endpoint to check OpenHexa configuration status:</p>
<pre><code class="language-http">GET /api/openhexa/pipelines/config/
</code></pre>
<p><strong>Response</strong>:</p>
<pre><code class="language-json">{
    &quot;configured&quot;: true,
    &quot;lqas_pipeline_code&quot;: &quot;lqas-sampling-pipeline&quot;
}
</code></pre>
<ul>
<li><code>configured</code>: Boolean indicating if all required parameters are present</li>
<li><code>lqas_pipeline_code</code>: Only included if present in configuration</li>
</ul>
<h2 id="api-endpoints">API Endpoints<a class="headerlink" href="#api-endpoints" title="Permanent link">#</a></h2>
<h3 id="pipeline-management">Pipeline Management<a class="headerlink" href="#pipeline-management" title="Permanent link">#</a></h3>
<h4 id="launch-pipeline">Launch Pipeline<a class="headerlink" href="#launch-pipeline" title="Permanent link">#</a></h4>
<pre><code class="language-http">POST /api/openhexa/pipelines/{pipeline_id}/launch/
Content-Type: application/json

{
    &quot;version&quot;: &quot;uuid-of-pipeline-version&quot;,
    &quot;config&quot;: {
        &quot;planning_id&quot;: 123,
        &quot;task_id&quot;: 456,
        &quot;org_unit_type_sequence_identifiers&quot;: [398, 399, 400],
        &quot;org_unit_type_quantities&quot;: [2, 3, 4],
        &quot;org_unit_type_exceptions&quot;: [&quot;12098,108033&quot;, &quot;&quot;, &quot;&quot;]
    }
}
</code></pre>
<p><strong>Note</strong>: The <code>connection_host</code> and <code>connection_token</code> parameters are automatically added to the config by the backend during pipeline launch. The frontend should not include these parameters in the request.</p>
<h4 id="update-task-status-pipeline-iaso">Update Task Status (Pipeline → Iaso)<a class="headerlink" href="#update-task-status-pipeline-iaso" title="Permanent link">#</a></h4>
<pre><code class="language-http">PATCH /api/openhexa/pipelines/{pipeline_id}/
Content-Type: application/json

{
    &quot;task_id&quot;: 456,
    &quot;progress_message&quot;: &quot;Pipeline completed successfully&quot;,
    &quot;progress_value&quot;: 100,
    &quot;end_value&quot;: 100,
    &quot;result_data&quot;: {
        &quot;assignments_created&quot;: 24,
        &quot;org_units_selected&quot;: [...],
        &quot;teams_assigned&quot;: [...]
    }
}
</code></pre>
<p><strong>Note</strong>: The <code>status</code> parameter is optional and not used by default. Status updates are handled automatically by Iaso's polling system. The pipeline should only send progress updates and messages.</p>
<h4 id="automatic-status-updates-iaso-openhexa">Automatic Status Updates (Iaso → OpenHEXA)<a class="headerlink" href="#automatic-status-updates-iaso-openhexa" title="Permanent link">#</a></h4>
<p>Status updates are handled automatically by the background polling system:</p>
<ul>
<li><strong>QUEUED</strong>: When pipeline is launched</li>
<li><strong>RUNNING</strong>: When OpenHEXA pipeline starts executing</li>
<li><strong>SUCCESS</strong>: When OpenHEXA pipeline completes successfully</li>
<li><strong>ERRORED</strong>: When OpenHEXA pipeline fails</li>
<li><strong>KILLED</strong>: When task is manually terminated</li>
</ul>
<p>The polling system continuously monitors OpenHEXA and updates Iaso task status accordingly.</p>
<h2 id="architecture-improvements">Architecture Improvements<a class="headerlink" href="#architecture-improvements" title="Permanent link">#</a></h2>
<h3 id="key-benefits-of-the-new-architecture">Key Benefits of the New Architecture<a class="headerlink" href="#key-benefits-of-the-new-architecture" title="Permanent link">#</a></h3>
<h4 id="1-reliable-status-management">1. <strong>Reliable Status Management</strong><a class="headerlink" href="#1-reliable-status-management" title="Permanent link">#</a></h4>
<ul>
<li><strong>Automatic Synchronization</strong>: Iaso task status always matches OpenHEXA pipeline status</li>
<li><strong>No Manual Updates</strong>: Status changes are handled automatically by the polling system</li>
<li><strong>Real-time Updates</strong>: Status changes are reflected immediately in the UI</li>
<li><strong>Consistent State</strong>: Eliminates status mismatches between systems</li>
</ul>
<h4 id="2-robust-pipeline-execution">2. <strong>Robust Pipeline Execution</strong><a class="headerlink" href="#2-robust-pipeline-execution" title="Permanent link">#</a></h4>
<ul>
<li><strong>Configurable Timeouts</strong>: Default 10-minute timeout prevents ghost tasks (configurable)</li>
<li><strong>Continuous Monitoring</strong>: Polls until pipeline reaches final state or timeout</li>
<li><strong>Error Recovery</strong>: Handles network errors and continues polling</li>
<li><strong>Kill Support</strong>: Respects task termination signals</li>
<li><strong>Timeout Protection</strong>: Prevents indefinite polling that could create ghost tasks</li>
</ul>
<h4 id="3-simplified-pipeline-development">3. <strong>Simplified Pipeline Development</strong><a class="headerlink" href="#3-simplified-pipeline-development" title="Permanent link">#</a></h4>
<ul>
<li><strong>Optional Status Updates</strong>: Pipelines can focus on business logic, not status management</li>
<li><strong>Progress Reporting</strong>: Pipelines can still send progress updates and messages</li>
<li><strong>Clean Separation</strong>: Status management is handled by Iaso, not the pipeline</li>
<li><strong>Reduced Complexity</strong>: Pipelines don't need to handle status transitions</li>
</ul>
<h4 id="4-better-user-experience">4. <strong>Better User Experience</strong><a class="headerlink" href="#4-better-user-experience" title="Permanent link">#</a></h4>
<ul>
<li><strong>Accurate Status</strong>: Users always see the correct pipeline status</li>
<li><strong>Real-time Feedback</strong>: Status updates happen automatically</li>
<li><strong>Reliable Monitoring</strong>: No more stuck or orphaned tasks</li>
<li><strong>Consistent Interface</strong>: Same task management interface for all pipeline types</li>
</ul>
<h4 id="5-improved-maintainability">5. <strong>Improved Maintainability</strong><a class="headerlink" href="#5-improved-maintainability" title="Permanent link">#</a></h4>
<ul>
<li><strong>Single Source of Truth</strong>: OpenHEXA is the authoritative source for pipeline status</li>
<li><strong>Centralized Logic</strong>: All status management logic is in one place</li>
<li><strong>Easier Debugging</strong>: Clear separation between pipeline logic and status management</li>
<li><strong>Better Testing</strong>: Status management can be tested independently</li>
</ul>
<h3 id="migration-from-previous-architecture">Migration from Previous Architecture<a class="headerlink" href="#migration-from-previous-architecture" title="Permanent link">#</a></h3>
<p>The new architecture is backward compatible with existing pipelines:</p>
<ul>
<li><strong>Existing Pipelines</strong>: Continue to work without modification</li>
<li><strong>Status Updates</strong>: Optional - pipelines can still send status updates if needed</li>
<li><strong>Progress Updates</strong>: Still supported and recommended for user feedback</li>
<li><strong>Error Handling</strong>: Improved error handling and recovery</li>
</ul>
<h3 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">#</a></h3>
<h4 id="for-pipeline-developers">For Pipeline Developers<a class="headerlink" href="#for-pipeline-developers" title="Permanent link">#</a></h4>
<ol>
<li><strong>Focus on Business Logic</strong>: Don't worry about status management</li>
<li><strong>Send Progress Updates</strong>: Use <code>safe_update_task_status()</code> for user feedback</li>
<li><strong>Handle Errors Gracefully</strong>: Let the polling system handle status updates</li>
<li><strong>Use Result Data</strong>: Include meaningful data in progress updates</li>
</ol>
<h4 id="for-frontend-developers">For Frontend Developers<a class="headerlink" href="#for-frontend-developers" title="Permanent link">#</a></h4>
<ol>
<li><strong>Monitor Task Status</strong>: Use the task status for UI updates</li>
<li><strong>Show Progress</strong>: Display progress messages from the pipeline</li>
<li><strong>Handle States</strong>: Implement proper UI states for each task status</li>
<li><strong>Real-time Updates</strong>: Use task polling for real-time status updates</li>
</ol>
<h3 id="assignment-management">Assignment Management<a class="headerlink" href="#assignment-management" title="Permanent link">#</a></h3>
<h4 id="delete-all-assignments-for-planning">Delete All Assignments for Planning<a class="headerlink" href="#delete-all-assignments-for-planning" title="Permanent link">#</a></h4>
<pre><code class="language-http">DELETE /api/assignments/?planning={planning_id}
</code></pre>
<h4 id="bulk-create-assignments">Bulk Create Assignments<a class="headerlink" href="#bulk-create-assignments" title="Permanent link">#</a></h4>
<pre><code class="language-http">POST /api/assignments/bulk_create_assignments/
Content-Type: application/json

{
    &quot;planning&quot;: 123,
    &quot;assignments&quot;: [
        {
            &quot;org_unit&quot;: 1001,
            &quot;team&quot;: 201,
            &quot;user&quot;: null
        },
        {
            &quot;org_unit&quot;: 1002,
            &quot;team&quot;: 202,
            &quot;user&quot;: 301
        }
    ]
}
</code></pre>
<h2 id="frontend-integration">Frontend Integration<a class="headerlink" href="#frontend-integration" title="Permanent link">#</a></h2>
<h3 id="user-workflow">User Workflow<a class="headerlink" href="#user-workflow" title="Permanent link">#</a></h3>
<p>The correct workflow for planning-pipeline integration is:</p>
<ol>
<li><strong>Planning Creation/Edition</strong>: User selects available pipelines (no parameters)</li>
<li><strong>Assignment Map View</strong>: User views current assignments and launches sampling</li>
<li><strong>Parameter Configuration</strong>: User configures sampling parameters in a dialog</li>
<li><strong>Pipeline Execution</strong>: System executes pipeline and updates assignments</li>
</ol>
<h3 id="planning-configuration-ui">Planning Configuration UI<a class="headerlink" href="#planning-configuration-ui" title="Permanent link">#</a></h3>
<p>The planning creation/edition dialog should include:</p>
<ol>
<li><strong>Pipeline Selection</strong>: Multi-select dropdown for available pipelines (only pipeline selection, no parameters) - Only visible if OpenHexa config is present</li>
<li>Selected pipelines are stored in the <code>pipeline_uuids</code> field as an array of UUIDs</li>
<li>This links specific pipelines to the planning configuration</li>
</ol>
<h3 id="assignment-view-ui-map-page">Assignment View UI (Map Page)<a class="headerlink" href="#assignment-view-ui-map-page" title="Permanent link">#</a></h3>
<p>The assignment details view (map page) should display:</p>
<ol>
<li><strong>Current Assignments</strong>: Table showing org units assigned to teams/users</li>
<li><strong>Visual Map</strong>: Geographic representation of assignments</li>
<li><strong>Pipeline Controls</strong>: Buttons to:</li>
<li><strong>Launch Sample</strong>: Open parameter configuration dialog</li>
<li>View pipeline status</li>
<li>Delete existing assignments (with confirmation)</li>
<li><strong>Parameter Configuration Dialog</strong>: Modal/dialog for:</li>
<li>Pipeline selection (if multiple available)</li>
<li>Org unit type hierarchy selection</li>
<li>Quantities at each level</li>
<li>Exception org units (comma-separated IDs to exclude per level)</li>
</ol>
<h3 id="workflow-details">Workflow Details<a class="headerlink" href="#workflow-details" title="Permanent link">#</a></h3>
<h4 id="step-1-planning-creationedition">Step 1: Planning Creation/Edition<a class="headerlink" href="#step-1-planning-creationedition" title="Permanent link">#</a></h4>
<ul>
<li>User creates or edits a planning</li>
<li>User selects which pipelines are available for this planning</li>
</ul>
<h4 id="step-2-assignment-map-view">Step 2: Assignment Map View<a class="headerlink" href="#step-2-assignment-map-view" title="Permanent link">#</a></h4>
<ul>
<li>User navigates to the assignment map view for the planning</li>
<li>User sees current assignments (if any) on the map and in the table</li>
<li>User sees "Launch Sample" button (only if OpenHexa is configured)</li>
</ul>
<h4 id="step-3-launch-sample">Step 3: Launch Sample<a class="headerlink" href="#step-3-launch-sample" title="Permanent link">#</a></h4>
<ul>
<li>User clicks "Launch Sample" button</li>
<li>If existing assignments exist, show confirmation dialog: "This will delete all existing assignments. Continue?"</li>
<li>Open parameter configuration dialog</li>
</ul>
<h4 id="step-4-parameter-configuration">Step 4: Parameter Configuration<a class="headerlink" href="#step-4-parameter-configuration" title="Permanent link">#</a></h4>
<ul>
<li>User selects pipeline (if multiple available)</li>
<li>User configures sampling parameters:</li>
<li>Org unit type hierarchy (from higher to lower level)</li>
<li>Quantities at each level</li>
<li>Exception org units to exclude (comma-separated IDs per level)</li>
<li>User clicks "Launch Pipeline" to execute</li>
</ul>
<h4 id="step-5-pipeline-execution">Step 5: Pipeline Execution<a class="headerlink" href="#step-5-pipeline-execution" title="Permanent link">#</a></h4>
<ul>
<li>System creates task and launches pipeline</li>
<li>User sees task status updates</li>
<li>System updates assignments when pipeline completes</li>
<li>User sees new assignments on map and in table</li>
</ul>
<h2 id="validation-rules">Validation Rules<a class="headerlink" href="#validation-rules" title="Permanent link">#</a></h2>
<h3 id="hierarchy-validation">Hierarchy Validation<a class="headerlink" href="#hierarchy-validation" title="Permanent link">#</a></h3>
<ol>
<li><strong>Org Unit Type Hierarchy</strong>: Must match team hierarchy depth</li>
<li><strong>Team Hierarchy</strong>: Must be compatible with org unit type structure</li>
<li><strong>Exception Validation</strong>: Exception org units must exist and be of correct type</li>
</ol>
<h3 id="pipeline-validation">Pipeline Validation<a class="headerlink" href="#pipeline-validation" title="Permanent link">#</a></h3>
<ol>
<li><strong>Parameter Validation</strong>: All required parameters must be provided</li>
<li><strong>Type Validation</strong>: Parameter types must match expected formats</li>
<li><strong>Range Validation</strong>: Quantities must be positive integers</li>
<li><strong>Existence Validation</strong>: All referenced IDs must exist in database</li>
</ol>
<h2 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">#</a></h2>
<h3 id="common-error-scenarios">Common Error Scenarios<a class="headerlink" href="#common-error-scenarios" title="Permanent link">#</a></h3>
<ol>
<li><strong>Hierarchy Mismatch</strong>: Org unit type hierarchy doesn't match team hierarchy</li>
<li><strong>Invalid Parameters</strong>: Missing or invalid pipeline parameters</li>
<li><strong>Pipeline Failure</strong>: OpenHexa pipeline execution fails</li>
<li><strong>Assignment Conflicts</strong>: Attempting to create duplicate assignments</li>
</ol>
<h3 id="error-response-format">Error Response Format<a class="headerlink" href="#error-response-format" title="Permanent link">#</a></h3>
<pre><code class="language-json">{
    &quot;error&quot;: &quot;Error message&quot;,
    &quot;details&quot;: {
        &quot;field&quot;: &quot;specific field error&quot;,
        &quot;code&quot;: &quot;ERROR_CODE&quot;
    }
}
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.action.edit"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.b78d2936.min.js"></script>
      
        <script src="../../../../../extrajs/html2pdf.bundle.min.js"></script>
      
        <script src="../../../../../extrajs/pdfDownload.js"></script>
      
        <script src="https://plausible.io/js/script.js"></script>
      
    
  </body>
</html>