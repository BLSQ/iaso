# Generated by Django 4.2.17 on 2025-02-03 13:19

from django.db import migrations
from plugins.polio.models.base import IncidentReport as IR


def migrate_physical_inventory_report_type(apps, schema_editor):
    IncidentReport = apps.get_model("polio", "IncidentReport")
    Choices = IR.StockCorrectionChoices

    incident_reports = IncidentReport.objects.all()
    for report in incident_reports:
        if report.stock_correction == Choices.PHYSICAL_INVENTORY:
            report.stock_correction = Choices.PHYSICAL_INVENTORY_ADD
            report.save()


def revert_physical_inventory_report_type(apps, schema_editor):
    IncidentReport = apps.get_model("polio", "IncidentReport")
    Choices = IR.StockCorrectionChoices

    incident_reports = IncidentReport.objects.all()
    for report in incident_reports:
        if report.stock_correction == Choices.PHYSICAL_INVENTORY_ADD:
            report.stock_correction = Choices.PHYSICAL_INVENTORY
            report.save()


class Migration(migrations.Migration):
    dependencies = [
        ("polio", "0218_alter_incidentreport_stock_correction"),
    ]

    operations = [
        migrations.RunPython(
            migrate_physical_inventory_report_type, revert_physical_inventory_report_type, elidable=True
        )
    ]
