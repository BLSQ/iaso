# Generated by Django 4.2.20 on 2025-06-19 14:36

from django.db import migrations


def data_migration(apps, schema_editor):
    Instance = apps.get_model("iaso", "Instance")
    FormVersion = apps.get_model("iaso", "FormVersion")
    instances = Instance.objects.filter(form_version__isnull=True).filter(json__isnull=False)
    for instance in instances:
        instance.form_version = FormVersion.objects.filter(version_id=instance.json["_version"]).first()
        instance.save()


def reverse(apps, schema_editor):
    pass


class Migration(migrations.Migration):
    dependencies = [
        ("iaso", "0327_orgunitchangerequest_deleted_at"),
    ]

    operations = [
        migrations.RunPython(data_migration, reverse),
    ]
